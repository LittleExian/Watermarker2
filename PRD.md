# Watermarker2 产品需求文档

## 1. 项目概述
Watermarker2是一款运行在Windows或MacOS平台上的本地应用程序，用于为图片添加文本或图片水印，支持批量处理和丰富的水印定制选项。

## 2. 功能需求

### 2.1 文件处理
#### 2.1.1 导入图片
- 支持单张图片拖拽或通过文件选择器导入
- 支持批量导入，可一次性选择多张图片或直接导入整个文件夹
- 在界面上显示已导入图片的列表（缩略图和文件名）

#### 2.1.2 支持格式
- 输入格式：必须支持JPEG, PNG。强烈建议支持BMP, TIFF。PNG格式必须支持透明通道
- 输出格式：用户可选择输出为JPEG或PNG

#### 2.1.3 导出图片
- 用户可指定一个输出文件夹。为防止覆盖原图，默认禁止导出到原文件夹
- 提供导出文件命名规则选项：
  - 保留原文件名
  - 添加自定义前缀（如wm_）
  - 添加自定义后缀（如_watermarked）
- 对于JPEG格式，提供图片质量（压缩率）调节滑块（0-100）（可选高级功能）
- 导出时允许用户调整图片尺寸（如按宽度、高度或百分比缩放）（可选高级功能）

### 2.2 水印类型
#### 2.2.1 文本水印
- 内容：用户可自定义输入任意文本
- 字体：可选择系统已安装的字体、字号、粗体、斜体（可选高级功能）
- 颜色：提供调色板让用户选择字体颜色（可选高级功能）
- 透明度：可调节文本的透明度（0-100%）
- 样式：可添加阴影或描边效果，以增强在复杂背景下的可读性（可选高级功能）

#### 2.2.2 图片水印（可选高级功能）
- 用户可从本地选择一张图片（如Logo）作为水印
- 必须支持带透明通道的PNG图片
- 缩放：可按比例或自由调整图片水印的大小
- 透明度：可调节图片水印的整体透明度（0-100%）

### 2.3 水印布局与样式
#### 2.3.1 实时预览
- 所有对水印的调整都应在主预览窗口中实时显示效果
- 用户可以点击图片列表切换预览不同的图片

#### 2.3.2 位置
- 预设位置：提供九宫格布局（四角、正中心），用户可一键将水印放置在这些位置
- 手动拖拽：用户可以直接在预览图上通过鼠标拖拽水印到任意位置

#### 2.3.3 旋转
- 提供一个滑块或输入框，允许用户以任意角度旋转水印（可选高级功能）

### 2.4 配置管理
#### 2.4.1 水印模板
- 用户可以将当前的水印设置（包括水印内容、字体、颜色、位置、大小、透明度等所有参数）保存为一个模板
- 用户可以加载、管理和删除已保存的模板
- 程序启动时可自动加载上一次关闭时的设置或一个默认模板

## 3. 界面设计建议

### 3.1 主界面布局
- 左侧：已导入图片列表（缩略图和文件名）
- 中央：图片预览区域，显示当前选中图片的水印效果
- 右侧：水印设置面板，包含所有水印相关的配置选项
- 顶部：菜单栏和主要操作按钮（导入、导出、保存模板等）
- 底部：状态栏，显示当前处理进度或提示信息

### 3.2 交互设计
- 拖拽操作：支持拖拽图片到应用窗口进行导入，支持拖拽水印调整位置
- 实时反馈：所有设置变更应在预览区实时显示效果
- 快捷键支持：常用操作提供键盘快捷键
- 操作确认：删除模板、批量处理等重要操作需提供确认对话框

## 4. 技术选型建议

### 4.1 开发语言与框架
- 考虑使用Python配合PyQt或Tkinter构建跨平台GUI界面
- 图片处理可使用Pillow(PIL)库
- 也可考虑使用Electron框架，基于Web技术（HTML, CSS, JavaScript）构建跨平台应用

### 4.2 核心功能实现关键点
- 图片导入/导出功能：使用系统文件对话框和图片处理库实现
- 水印添加算法：确保在不破坏原图质量的前提下，正确处理透明度和混合模式
- 批量处理机制：考虑使用多线程或异步处理，提高大量图片的处理效率
- 配置保存与加载：使用JSON或XML格式存储模板配置

## 5. 其他重要说明

### 5.1 性能要求
- 确保图片预览流畅，即使是处理大尺寸图片
- 批量处理时应提供进度显示，并优化处理速度

### 5.2 安全性考虑
- 确保应用程序不对用户系统造成安全隐患
- 处理用户文件时注意权限问题，避免未经授权的文件访问

### 5.3 用户体验优化
- 提供详细的用户手册或帮助文档
- 添加操作提示和错误处理机制
- 支持深色模式等个性化设置

## 6. 版本规划

### 6.1 基础版本（MVP）
- 实现单张图片的文本水印添加功能
- 支持JPEG和PNG格式的导入导出
- 提供基本的水印位置调整和透明度设置
- 实现简单的文件命名规则

### 6.2 进阶版本
- 添加批量处理功能
- 增加图片水印支持
- 实现水印模板管理功能
- 优化界面交互体验

### 6.3 高级版本
- 增加更多水印样式选项（阴影、描边等）
- 提供图片质量调节和尺寸调整功能
- 支持更多图片格式
- 添加水印旋转功能